# DogsRandomCollection Smart Contract

This Solidity smart contract is called DogsRandomCollection and is based on the ERC721 standard. Its purpose is to mint NFTs (Non-Fungible Tokens) representing different dog breeds in a random fashion. The metadata is generated by AI  and images are taken from the internet. Both of them are deployed to Pinata for decentralized access. This project was inspired by Patrick Collins' Free Code Camp tutorial video. However, I have made improvements to gas efficiency, fixed a bug with a token counter, and added tests to cover the breed randomness received from the VRF (Verifiable Random Function) functions.

The contract makes use of Chainlink's VRF (Verifiable Random Function) to generate random numbers securely and ensure that the dog breed distribution is even. The breed is chosen from a predefined set of options and the contract's owner can adjust the price of minting a new token. In addition, the contract owner can withdraw the accumulated balance in the contract account.

Link to testnet opeansea collection https://testnets.opensea.io/collection/random-doggy-dogs-3

Link to verified contract at bscscan: https://testnet.bscscan.com/address/0x7a3ca232a462e063eef49d3f8f55947cdb04a349#code

## Requirements

- `@chainlink/contracts/src/v0.8/interfaces/VRFCoordinatorV2Interface.sol`
- `@chainlink/contracts/src/v0.8/VRFConsumerBaseV2.sol`
- `@openzeppelin/contracts/token/ERC721/extensions/ERC721URIStorage.sol`
- `hardhat/console.sol`

## Installation

1. Clone this repository
2. Install the required dependencies with `npm install`
3. Compile the contract with `npx hardhat compile`

## Usage

1. Deploy the contract to a local or public network using Hardhat
2. Call the `purchaseDog` function to purchase a random dog NFT
3. After a random number has been generated by Chainlink VRF, the contract will mint a new NFT with the determined breed
4. The NFT can be transferred or displayed as desired

## License

This project is licensed under the terms of the MIT license.

## Functions

### `purchaseDog()`

Initiates the generation of a random dog breed for an NFT.

### `fulfillRandomWords(uint256 requestId, uint256[] memory randomWords) internal override`

Callback function for the Chainlink VRF that generates the random dog breed and mints the NFT.

### `getBreed(uint8 dogType) public pure returns (Breed)`

Converts the randomly generated number into a Breed type, which represents the dog breed for the NFT.

### `withdraw() public only(owner)`

Allows the owner of the contract to withdraw the contract's balance.

### `changeMintPrice(uint256 newPrice) public only(owner)`

Allows the owner of the contract to change the `mint_fee` value to a new price.

### `getDogTokenUri(uint256 index) public view returns (string memory)`

Returns the URI of the image associated with a particular dog breed. The `index` parameter corresponds to the Breed enum.
# NftOnRevealLowerGas Contract

This contract is an ERC721 implementation created as a part of HashLips ERC721 tutorial, with some gas optimization improvements made by the author.

## Prerequisites

- Solidity version >=0.7.0 <0.9.0
- `@openzeppelin/contracts/token/ERC721/ERC721.sol` library
- `@openzeppelin/contracts/utils/Counters.sol` library
- `@openzeppelin/contracts/access/Ownable.sol` library

## Contract Details

The `NftOnRevealLowerGas` contract extends the ERC721 standard and includes additional functionalities to manage and mint NFTs.

### Contract Variables

- `uriPrefix`: A string variable representing the prefix of the token URI.
- `uriSuffix`: A string variable representing the suffix of the token URI.
- `hiddenMetadataUri`: A string variable representing the URI for hidden metadata.
- `cost`: A uint256 variable representing the cost (in Ether) to mint each NFT.
- `maxSupply`: A uint256 variable representing the maximum supply limit for NFTs.
- `maxMintAmountPerTx`: A uint256 variable representing the maximum number of NFTs that can be minted per transaction.
- `paused`: A boolean variable indicating whether the contract is paused.
- `revealed`: A boolean variable indicating whether the NFTs have been revealed.

### Contract Functions

#### `totalSupply()`

```solidity
function totalSupply() public view returns (uint256)
```

Returns the total number of NFTs that have been minted.

#### `mint(uint256 _mintAmount)`

```solidity
function mint(uint256 _mintAmount) public payable mintCompliance(_mintAmount)
```

Allows users to mint a specified number of NFTs by sending the required amount of Ether. The `_mintAmount` parameter specifies the number of NFTs to mint.

#### `mintForAddress(uint256 _mintAmount, address _receiver)`

```solidity
function mintForAddress(uint256 _mintAmount, address _receiver) public mintCompliance(_mintAmount) onlyOwner
```

Allows the contract owner to mint a specified number of NFTs on behalf of a specified receiver address. The `_mintAmount` parameter specifies the number of NFTs to mint, and the `_receiver` parameter specifies the address of the receiver.

#### `walletOfOwner(address _owner)`

```solidity
function walletOfOwner(address _owner) public view returns (uint256[] memory)
```

Returns an array of token IDs owned by the specified `_owner` address.

#### `tokenURI(uint256 _tokenId)`

```solidity
function tokenURI(uint256 _tokenId) public view virtual override returns (string memory)
```

Returns the URI for a specific token ID. If the NFTs have not been revealed, the function returns the hidden metadata URI. Otherwise, it constructs the token URI using the base URI, token ID, and URI suffix.

#### `setRevealed(bool _state)`

```solidity
function setRevealed(bool _state) public onlyOwner
```

Allows the contract owner to set the revealed state of the NFTs. The `_state` parameter specifies whether the NFTs are revealed or hidden.

#### `setCost(uint256 _cost)`

```solidity
function setCost(uint256 _cost) public onlyOwner
```

Allows the contract owner to set the cost (in Ether) to mint each NFT. The `_cost` parameter specifies the new cost.

#### `setMaxMintAmountPerTx(uint256 _maxMintAmountPerTx)`

```solid

ity
function setMaxMintAmountPerTx(uint256 _maxMintAmountPerTx) public onlyOwner
```

Allows the contract owner to set the maximum number of NFTs that can be minted per transaction. The `_maxMintAmountPerTx` parameter specifies the new maximum mint amount.

#### `setHiddenMetadataUri(string memory _hiddenMetadataUri)`

```solidity
function setHiddenMetadataUri(string memory _hiddenMetadataUri) public onlyOwner
```

Allows the contract owner to set the URI for hidden metadata. The `_hiddenMetadataUri` parameter specifies the new hidden metadata URI.

#### `setUriPrefix(string memory _uriPrefix)`

```solidity
function setUriPrefix(string memory _uriPrefix) public onlyOwner
```

Allows the contract owner to set the prefix of the token URI. The `_uriPrefix` parameter specifies the new URI prefix.

#### `setUriSuffix(string memory _uriSuffix)`

```solidity
function setUriSuffix(string memory _uriSuffix) public onlyOwner
```

Allows the contract owner to set the suffix of the token URI. The `_uriSuffix` parameter specifies the new URI suffix.

#### `setPaused(bool _state)`

```solidity
function setPaused(bool _state) public onlyOwner
```

Allows the contract owner to pause or unpause the contract. The `_state` parameter specifies whether to pause or unpause the contract.

#### `withdraw()`

```solidity
function withdraw() public onlyOwner
```

Allows the contract owner to withdraw the contract's balance to their address.

#### `__mintLoop(address _receiver, uint256 _mintAmount)`

Internal function used to mint a specified number of NFTs and assign them to the `_receiver` address.

#### `_baseURI()`

Internal function used to get the base URI for the token.
